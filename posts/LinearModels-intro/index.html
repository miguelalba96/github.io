<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Linear models 101! - Introduction" /><meta name="author" content="Miguel Alba" /><meta property="og:locale" content="en" /><meta name="description" content="Simple Linear Regression" /><meta property="og:description" content="Simple Linear Regression" /><link rel="canonical" href="https://miguelalba96.github.io/posts/LinearModels-intro/" /><meta property="og:url" content="https://miguelalba96.github.io/posts/LinearModels-intro/" /><meta property="og:site_name" content="Miguel Alba" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-14T01:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Linear models 101! - Introduction" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Miguel Alba" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Miguel Alba"},"description":"Simple Linear Regression","url":"https://miguelalba96.github.io/posts/LinearModels-intro/","@type":"BlogPosting","headline":"Linear models 101! - Introduction","dateModified":"2021-11-04T16:54:13+01:00","datePublished":"2021-10-14T01:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://miguelalba96.github.io/posts/LinearModels-intro/"},"@context":"https://schema.org"}</script><title>Linear models 101! - Introduction | Miguel Alba</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Miguel Alba"><meta name="application-name" content="Miguel Alba"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/me.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Miguel Alba</a></div><div class="site-subtitle font-italic">Posts on ML, Stats and general purpose data science</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/research/" class="nav-link"> <i class="fa-fw fas fa-flask ml-xl-3 mr-xl-3 unloaded"></i> <span>RESEARCH</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/miguelalba96" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.instagram.com/malba96" aria-label="instagram" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['albaacosta','uni-potsdam.de'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/miguelalba96" aria-label="linkedin" class="order-6" > <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Linear models 101! - Introduction</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Linear models 101! - Introduction</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Miguel Alba </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Oct 14, 2021, 1:00 AM +0200" >Oct 14, 2021<i class="unloaded">2021-10-14T01:00:00+02:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Nov 4, 2021, 4:54 PM +0100" >Nov 4, 2021<i class="unloaded">2021-11-04T16:54:13+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5434 words">30 min read</span></div></div><div class="post-content"><h1 id="simple-linear-regression">Simple Linear Regression</h1><p>We can express the behavior of several things around nature based on their relationships. There are several types of relationships between things, some of them could describe how to phenomenons are possibly linked, and some of them could be useful to understand the particular interaction between occurrences or situations. This interaction could produce most of the time outcomes or predictions.</p><p>Predictions are based in the intuitive and mathematical relation between what is already known and what is to be estimated. If a practitioner could determinate how what is known today relates to a future event, they could use these insights to help considerably the decision making process of an institute/organization.</p><p>Francis Galton was responsible for the use of the term <em>regression</em>. In a famous essay, Galton claimed that, despite the tendency of tall parents to produce tall children and short parents to produce short children, the average height of the children of parents of a given height tended to shift, or “regress,” to the average height of the total population.</p><p>Regression analysis deals with the study of the dependence of a variable (dependent variable) on one or more variables (explanatory variables) with the objective of estimating or predicting the population mean or average value of the dependent variable.</p><h2 id="linear-regression-with-two-variables">Linear Regression with two variables</h2><p>The first step in determining whether a relationship exists between two variables is to examine the graph of the observed (or known) data. This graph, or plot, is called a scatter plot.</p><p>A scatter plot can give us two types of information. First, we can visually identify patterns that indicate that the variables are related. If this happens, we can see what kind of line, or estimated equation, describes this relationship. Second, it gives us an indication about the scale of the variables.</p><p>Using R and ggplot a scatter plot could be visualized as follows:</p><div class="language-R highlighter-rouge"><div class="code-header"> <span text-data=" R "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">first_variable</span><span class="p">,</span><span class="w"> </span><span class="n">second_variable</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">categorical_variable</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">
</span></pre></table></code></div></div><p>In Python using the module <code class="language-plaintext highlighter-rouge">seaborn</code> and a <code class="language-plaintext highlighter-rouge">pandas</code> data frame we can plot the scatter plot of two variables as follows:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="c1"># dataset should be a pd.DataFrame
</span><span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"first_variable"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"second_variable"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"categorical_variable"</span><span class="p">)</span>
</pre></table></code></div></div><p>This is an example of a scatter plot for some of the attributes of the dataset <code class="language-plaintext highlighter-rouge">mtcars</code>, this dataset is composed by fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models), you can see more information <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html">here</a>.</p><p><img data-proofer-ignore data-src="/assets/posts/linear_models/scatter2.svg" alt="ScatterPlot2" /></p><p>In this case the linear relationship is visible between Miles/(US) gallon (mpg) and Displacement (disp) segregated by the transmission (0: automatic, 1: manual), we can see that if the Miles/gallon increase the displacement of the car decreases. So there is an inverse relation between both variables.</p><p>These linear relationships are sometimes not so common in other datasets, an example of this behavior is the following plot of the Corruption vs Democracy index segregated by world region (data extracted from <a href="https://www.gapminder.org/">gapminder</a>)</p><p><img data-proofer-ignore data-src="/assets/posts/linear_models/scatter_plot.svg" alt="ScatterPlot" /></p><p>We can see how there is no visual linear relation between both variables.</p><h3 id="regression-and-correlation">Regression and correlation</h3><p>Correlation analysis is closely related to regression analysis, although conceptually the two are very different. In correlation analysis, the main objective is to measure the strength or degree of linear association between two variables.</p><p>In regression analysis there is a difference in treatment between the two variables studied that begins with their names: dependent and explanatory variables. A dependent variable is assumed to be statistical, random or stochastic, i.e., it has a probability distribution. In the other hand, we can consider initially that a explanatory variable is fixed (the deterministic component of a model).</p><h3 id="covariance">Covariance</h3><p>Covariance indicates the relationship between two quantitative variables. The covariance between the variable “x” and the variable “y” is denoted and calculated as follows:</p>\[cov(x,y)=\sigma_{xy}=\mathbb{E}[(X-\mu_x)(Y-\mu_y)]\]<p>*This is known as the population covariance</p><p>Where $\mu_x$ is the population average for the variable $X$, $\mu_y$ is the population average for the variable $Y$ and $\mathbb{E}$ is a expected value.</p><p>In the case of the sample covariance we have the following term:</p>\[cov(x,y)=\frac{\sum_{i=1}^{n}{(x_i - \bar{x})(y_i - \bar{y})}}{n}\]<p>where $\bar{x}$ and $\bar{y}$ correspond to the sample average for $x$ and $y$ respectively and $n$ is the number of samples</p><p>If the covariance value is positive, it indicates that the variables are directly related, i.e. when the values of one variable increase, the values of the other variable also increase. On the other hand, if the value of the covariance is negative, it indicates that the variables are inversely related, i.e. when the values of one variable increase, those of the other decrease.</p><p>However, if the covariance between two variables is zero, it indicates that there is no linear relationship between the variables.</p><p>The covariance as a measure of the relationship between 2 variables has the following properties:</p><ul><li>It is invariant to changes in the origin of the two variables.<li>Depends on unit changes, changing the unit of measurement of both variables changes the covariance.<li><p>Calculating the covariance can also be written as follows:</p>\[S_{xy}=a_{11} - \bar{x}\bar{y}\]<p>Where $a_{11}$ (central mixed moment of order 1,1) has the following forms:</p><p>$a_{11}=\frac{1}{N}\sum_{\forall i}{\sum_{\forall j}{x_i y_i n_{ij}}}$, when the observations are aggregated by frequencies</p><p>$a_{11}=\frac{1}{N}\sum_{\forall i}{\sum_{\forall j}{x_i y_i}}$ when the observations are <strong>NOT</strong> aggregated by frequencies</p><li>If the two variables are independent, their covariance is zero.<li>The covariance sees a joint comparison between two variables, if it is positive it will give us the information that at high values of one of the variables there is a greater tendency to find high values of the other variable and the other way around for low values in one of the variables. On the other hand, if the covariance is negative, the covariation of both variables will be in the opposite direction: high values will correspond to low values, and low values to high values. If the covariance is zero, there is no clear covariation in either direction. However, the fact that the covariance depends on the variables measurements does not allow comparisons to be made between one case and another.</ul><h3 id="correlation">Correlation</h3><p>The term correlation is used to denote the existence of a numerical relationship between the variables analyzed. A correlation coefficient expresses quantitatively the magnitude and direction of the relationship between two variables.</p><p>Magnitude refers to the closeness of the scatter plot data to a straight line. If the points on the graph are very close to a straight line, the correlation is said to be very strong, while if the points are far from a straight line, the correlation is weak.</p><p>Correlation is the degree of linear association between two quantitative variables. If two variables are linearly related, it indicates that a change in the value of one of them will generate a change in the other. To measure the association strength that exists between two variables the Pearson’s coefficient is the most commonly used statistic.</p><p>The direction of the linear relationship between the two variables analyzed can be of two types:</p><ol><li><u>Direct or positive relationship</u>: When as one variable increases, the other variable also increases.<li><u>Inverse or negative relationship</u>: When one variable increases and the other variable decreases. Example: This is the case when analyzing the nominal value of standard vehicles and their years of use; the more years of use, the lower the nominal value.</ol><p>The correlation calculated using Pearson’s coefficient estimated from the data has the following form:</p>\[\rho=\frac{\sigma_{xy}}{\sigma_{x}\sigma_{y}}\]<p>where $\sigma_{x}$ and $\sigma_{y}$ are the population variance for $x$ and $y$ respectively and $\sigma_{xy}$ is the population covariance.</p><p>The sample Pearson’s coefficient has the following form:</p>\[\gamma = \frac{cov(x,y)}{s_x s_y}\]<p>where $s_x$ and $s_y$ are the sample variances for $x$ and $y$ respectively.</p><p>If the last expression is written in more detail, it has the following form:</p>\[r_{xy}=\frac{\sum_{i=1}^{n}{w_i(x_i-\bar{x})(y_i-\bar{y})}}{S_X S_Y (\sum{w_i} - 1)}\]<p>where:</p><ul><li>$w_i$ represents expansion factors for each data pair $(x_i, y_i)$ (The expansion factor is a weight that is applied to each study unit in the sample to obtain a population estimate)<li>$S_X$ and $S_Y$ are the standard deviations of both variables.</ul><p>The correlation coefficient has the following properties:</p><ul><li>$r_{xy}$ is always between -1 and 1.<li>$r_{xy}$ is positive when there is a positive relationship between both variables.<li>$r_{xy}$ is negative when there is an inverse relationship between both variables.<li>$r_{xy}$ is close to zero when there is no linear relation between both variables.</ul><p>By viewing a scatter plot and calculating the correlation coefficient, the following aspects can be determined:</p><ul><li><p>If the coefficient is very close to 1, it is because the points are very close to a straight line with a positive slope. When the coefficient approaches -1, the scatter plot will show the data decaying in an inverse or negative effect (Like in the <code class="language-plaintext highlighter-rouge">mtcars</code> example above).</p><li><p>If the coefficient is closer to zero it is because the points clustered around the line are not close to it (they are more random), there is no relationship between the variables.</p><li><p>If the coefficient is closer to zero and the scatter plot shows strange shapes, this indicates a clear nonlinear behavior between the variables and it is necessary to use other types of measures to obtain this relationship or transformations in the models.</p></ul><p>In R we can compute the correlation between a group of variables using <code class="language-plaintext highlighter-rouge">cor(data)</code>, for the <code class="language-plaintext highlighter-rouge">mtcars</code> example the correlation between <code class="language-plaintext highlighter-rouge">mpg</code> and <code class="language-plaintext highlighter-rouge">disp</code> is -0.84755, this is a final indication that both variables have an inverse relation. In Python we can use <code class="language-plaintext highlighter-rouge">numpy.corrcoef(data_array)</code>.</p><h3 id="regression-analysis">Regression Analysis</h3><p>If the dependence of a variable with respect to a single explanatory variable is studied, such a study is considered as a <strong>simple regression analysis</strong>, or <strong>two-variable regression analysis</strong>. However, if the dependence of a variable is studied with respect to more than one explanatory variable, it is called a <strong>multiple regression analysis</strong>. In other words, in a <strong>two-variable regression analysis</strong> there is only one explanatory variable, while in a multiple regression analysis there is more than one explanatory variable.</p><p>At first glance we can see from a scatter plot if indeed two variables are related, as a result, we can draw, or “fit” a straight line through our scatter plot to represent the relationship.</p><p>When a line is drawn through the points of a scatter plot we are able to identify the degree of association between the variables. The line drawn through the points represents a direct relationship, because $Y$ increases as $X$ increases. If the points are relatively close to this line, we can say that there is a high degree of association between the variable $X$ and the variable $Y$.</p><p>For using and calculating simple linear regression models, the following aspects should be taken into account:</p><ul><li>Variable $Y$ is known as the <em>response/dependent</em> variable, this is the variable of interest that was chosen.<li><p>Variable $X$ is known as the <em>explanatory/independent</em> variable and this is the one that will attempt to have a direct relationship with the <em>response/dependent</em> variable.</p><li><p>Both the <em>response/dependent</em> variable $Y$ and the <em>explanatory/independent</em> variable $X$ need to be highly correlated in order to expect a good scatter plot showing the linear relationship, if this does not occur there is probably another type of non-linear dependencies not considered by the proposed model.</p><li>In <strong>Machine Learning</strong> a synonym for these two variables are <code class="language-plaintext highlighter-rouge">target</code> (dependent variable) and <code class="language-plaintext highlighter-rouge">feature</code> (independent variable)</ul><p>The relationship between variables $X$ and $Y$ can also take the form of a curve. Statisticians call it a curvilinear relationship.</p><p>To understand regression models we must go to the simplest step in which there is a possible relationship between two quantitative variables, by painting in a scatter plot the variable $X$ and $Y$ we can fit a line that represents the behavior of the data under a slope and an intercept, this line is known as <strong>Simple Linear Regression</strong> Line and is written as follows:</p>\[y=\beta x + \varepsilon\]<p>Where $y$ is an associated term to the dependent variable, $x$ for the independent variable, $\beta$ its associated slope or parameter and $\varepsilon$ the errors of the model which allow to evidence the exactitude with which the model fits the data.</p><p>A model can also be expressed as a <em>predictive function</em> as follows:</p>\[y=f(x_i)\]<p>Where $f$ is intended to show that the variable $y$ is a function of the variable $x$.</p><p>After considering all this, some questions arise: <em>How can the beta parameter be estimated?</em> For this it is necessary to understand that the proposed model is considered as a model <strong>without intercept</strong>; this means that when drawing the regression line through the scatter diagram the beginning of the line will be at the coordinate (0,0) of the Cartesian plane.</p><p>In general cases, models with intercept are more commonly used since the behavior of the data does not always follow a straight line pattern starting at the origin, for the case in which it is necessary to draw a regression line with intercept, the following model can be used:</p>\[y=\beta_0 + \beta_1 x + \varepsilon\]<p>The most common way to calculate the parameter of the simple linear regression is the <strong>least squares method</strong>.</p><p>$y=\beta_0 + \beta_1 x + \varepsilon$ is the model that perfectly fits the population, something that in practice is impossible (we have samples not all data). Thus, this model could be written in terms of expected values such as $\mathbb{E}[Y| X_i] = f(x_i)$ or $\mathbb{E}[Y | X_i] = \beta_0 + \beta_1 x_i$, so we use the following model known as <em>(sample regression function)</em> with similar notation to show what we want to estimate:</p>\[\hat{y}=\hat{\beta}_0 + \hat{\beta}_1 x + \hat{\varepsilon}\]<p>In terms of matrix notation, this expression can be seen as follows:</p>\[\begin{bmatrix} y_{1}\\ \vdots \\ y_{n} \end{bmatrix} =\begin{bmatrix} 1 &amp; x_{11}\\ \vdots &amp; \vdots \\ 1 &amp; x_{1n} \end{bmatrix}\begin{bmatrix} \beta _{0}\\ \beta _{1} \end{bmatrix} +\begin{bmatrix} \varepsilon _{1}\\ \vdots \\ \varepsilon _{n} \end{bmatrix}\]<p>We use the symbol “hat” (ex. $\hat{y}$) to represent the individual values of the estimated points, i.e., those points that are on the estimated line.</p><h4 id="variables-linearity">Variables linearity</h4><p>Linearity refers to the point at which the conditional expectation of $Y$ is a linear function of $X_i$ in a population model. Geometrically, the regression curve in this case is a straight line. In this interpretation, a regression function such as $\mathbb{E}[Y | X_i] = \beta_0 + \beta_1 x^2_i$ is not a linear function because the variable $x$ is squared.</p><h4 id="parameters-linearity">Parameters linearity</h4><p>The second interpretation of linearity is produced when $\mathbb{E}[Y | X_i]$ is a linear function of the parameters $\beta$, such as $\mathbb{E}[Y | X_i] = \beta_0 + \beta_1^2 x_i$, which is non-linear with respect to $\beta_1$. This case is an example of a <strong>non-linear regression model (in the parameter)</strong>.</p><h2 id="parameter-estimation">Parameter estimation</h2><p>For the parameter estimation in linear regression models, in general, the most widely known estimation method is called <strong>Ordinary Least Squares Method (OLS)</strong>.</p><p>In the case of the model with intercept, the following reasoning is used to estimate $\hat{\beta}_1$ and $\hat{\beta}_0$:</p><ol><li><p>We estimate $\hat{\beta}_1$ as follows:</p>\[\hat{\beta}_1 = \frac{\sum{xy}-n\bar{x}\bar{y}}{\sum{x^2} - n\bar{x}^2}\]<p>simplified it can also be written as:</p>\[\hat{\beta}_1 = \frac{\sum{(x_i -\bar{x})(y_i -\bar{y})}}{\sum{(x_i - \bar{x})^2}}=\frac{S_{xy}}{S_{xx}}\]<li><p>Then the intercept $\hat{\beta}_0$ can be calculated as follows:</p>\[\hat{\beta}_0=\bar{y} - \hat{\beta}_1 \bar{x}\]<p>where $\hat{\beta}_0$ represents the expected value in $Y$ when $X$ is equal to zero and $\hat{\beta}_1$ represents the variation in $Y$ when $X$ increases in one unit (the derivative of $Y$ w.r.t $X$)</p></ol><h2 id="ordinary-least-squares-properties">Ordinary Least Squares properties</h2><p>The ordinary least squares method is attributed to Carl Friedrich Gauss, a German mathematician. The least squares method has very attractive statistical properties that have made it one of the most effective and popular methods of regression analysis. Lets have a look to the principles behind this estimation technique.</p><p>Considering the regression model:</p>\[y=\hat{\beta}_0 + \hat{\beta}_1 x + \hat{\varepsilon}\] \[=\hat{y} + \hat{\varepsilon}\]<p>where</p>\[\hat{\varepsilon}=y -\hat{y}\] \[\hat{\varepsilon}=y - \hat{\beta}_0 + \hat{\beta}_1 x_i\]<p>These residuals correspond to the vertical distances between the values that did not fit the model and the regression line, in order to identify if the proposed model is good, it is necessary to check if the amount of errors is close to zero computing the following total distance:</p>\[S = \sum_{i=1}^{n}{\hat{\varepsilon}_i}\] \[S=\sum_{i=1}^{n}{\hat{\varepsilon}_i}=\sum_{i=1}^{n}{(y_i - \hat{y}_i)^2} = \sum_{i=1}^{n}{(y_i - \hat{\beta}_0 + \hat{\beta}_1 x_i)^2}\]<p>Then the objective is minimize this distance, also named as the sum of squares $S$ of the difference between the observed dependent variable and the predictions given by the linear function.</p><p>The estimators obtained above ($\hat{\beta}_0$ and $\hat{\beta}_1$) are known as least squares estimators, since they are derived from the ordinary least squares principle. These estimators have two types of properties:</p><ol><li><p><em>Numerical properties</em>: Those that hold as a consequence of using ordinary least squares, regardless of how the data were generated.</p><li><p><em>Statistical properties</em>: Those that hold only with certain assumptions about the way the data were generated.</p></ol><p>These different properties can be further described as follows:</p><ul><li><p>OLS estimators are expressed only in terms of the quantities (i.e., $X$ and $Y$ ) observable (i.e., samples).</p><li><p><em>They are point estimators</em>: Given the sample, each estimator provides only one (point) value of the relevant population parameter (not an interval).</p><li><p>Once the OLS estimators of the sample data are obtained, the sample regression line is obtained without farther calculations, this line has the following properties:</p><ol><li><p>Passes through the sample means of $Y$ and $X$. As $\bar{y} = \hat{\beta}_0 + \hat{\beta}_1 \bar{x}$</p><li><p>The mean value of the estimated $Y$ ($\hat{y}_i$) is equal to the mean value of the real $Y$ for:</p>\[\hat{y}_i=\hat{\beta}_0 + \hat{\beta}_1 x_i\] \[=(\bar{y} - \hat{\beta}_1 \bar{x}) + \hat{\beta}_1 x_i\] \[=\bar{y} + \hat{\beta}_1 (x_i - \bar{x} )\]<p>When adding both sides of the last equality over the sample values and dividing by the sample size $n$, we obtain:</p>\[\bar{\hat{y}}=y\]<li><p>The average of the residuals is 0.</p>\[-2\sum_{i=1}^{n}{y_i - \hat{\beta}_0 + \hat{\beta}_1 x_i}=0\]<p>However, as $\hat{\varepsilon}_i= y_i - \hat{\beta}_0 + \hat{\beta}_1 x_i $, the last equation gets reduced to:</p>\[-2\sum_{i=1}^{n}{\hat{\varepsilon}_i}=0\]<p>The expression $y=\hat{\beta}_0 + \hat{\beta}_1 x + \hat{\varepsilon}$ could be defined in a way $X$ and $Y$ are expressed as deviations of their means. for such purpose, we can sum the equation in both sides as follows:</p>\[\sum{y}=n \hat{\beta}_0 + \hat{\beta}_1 \sum{x_i} + \sum{\hat{\varepsilon}_i}\]<p>when diving by $n$ we obtain:</p>\[\bar{y} = \hat{\beta}_0 + \hat{\beta}_1 \bar{x}\]<p>where, subtracting $y_i = \hat{\beta}_0 + \hat{\beta}_1 x_i + \hat{\varepsilon}_i$, we can obtain:</p>\[y_i - \bar{y} = \hat{\beta}_1 (x_i - \bar{x} ) + \hat{\varepsilon}\]<p>or</p>\[y_i = \hat{\beta}_1 x + \hat{\varepsilon}\]<p>which as mentioned before, it corresponds to a model without intercept or also called deviation form.</p></ol><li><p>The residuals are not correlated with the predicted value $y_i$.</p><li><p>The residuals are not correlated with $x_i$.</p></ul><p>The function <code class="language-plaintext highlighter-rouge">lm</code> can be used to estimate the parameters of a linear model using ordinary least squares in R, this function can be used as follows:</p><div class="language-R highlighter-rouge"><div class="code-header"> <span text-data=" R "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">~</span><span class="n">independent_variable</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">my_dataset</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p>In Python using <code class="language-plaintext highlighter-rouge">LinearRegression</code> from the scikit-learn module:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">independent_variable</span><span class="p">,</span> <span class="n">dependent_variable</span><span class="p">)</span>
</pre></table></code></div></div><p>To view the estimated parameters in R use the function <code class="language-plaintext highlighter-rouge">summary(model)</code> or directly in the form <code class="language-plaintext highlighter-rouge">model$coefficients</code>.</p><p>In Python the <code class="language-plaintext highlighter-rouge">LinearRegression</code> object does not contain a built-in model summary as in R, however we can still see the coefficients using the <code class="language-plaintext highlighter-rouge">model.coef_</code> method. Note: There are some solutions to see the model summary in detail using additional modules, you can have a look to this <a href="https://stackoverflow.com/questions/26319259/how-to-get-a-regression-summary-in-scikit-learn-like-r-does">thread</a>.</p><h2 id="variance-analysis">Variance analysis</h2><p>After constructing the parameter estimates, the question to be answered is: Does the variable $X$ have a significant effect on $Y$?</p><p>By a statistically significant effect we mean an effect that is large enough to be considered statistically different from zero. In order to give an answer to this question, it is necessary to consider the following hypothesis:</p>\[H_0=\beta_1=0\] \[H_a=\beta_1\neq 0\]<p>Which can be judged using statistical tests taken from the <em>analysis of variance table.</em></p><p>An analysis of variance table divides the variance of $Y$ into two parts:</p><ol><li>A part related to the contribution of $X$ to $Y$.<li>A part related to the contribution of the residuals of the model</ol><p>Using this table we can understand if the contribution of the variable $X$ is larger than the contribution of the residuals of the model $\varepsilon$.</p><p>Visually, an analysis of variance table looks like this:</p><div class="table-wrapper"><table><thead><tr><th>Causes of variation<th>Degrees of freedom<th>Sum of Squares<th>Mean Squares<th>F statistic<th>P-value<tbody><tr><td>Model<td>1<td>$SSR$ or $ESS$<td>$MSR$<td> <td> <tr><td>Error (residuals)<td>n-2<td>$RSS$<td>$MSE$<td> <td> <tr><td>Total<td>n-1<td>$TSS$<td> <td> <td> </table></div><p>The total variability of $Y$ can be expressed as sum between a part explained by the model and a second part associated to the error, this is is represented as follows:</p>\[\sum_{i=1}^{n}{(y_i - \bar{y})^2} = \sum_{i=1}^{n}{(\hat{y}_i - \bar{y})^2} + \sum_{i=1}^{n}{\varepsilon^2_i}\]<p>The first part is known as the total sum of squares TSS and the second as the explained sum of squares (sum of squares of the model) plus the sum of squares of the error SSE+SSR.</p><p>Following the notations in the table, the mean squares are constructed by dividing each sum of squares by their respective degrees of freedom, while the F-statistic has the form:</p>\[F=\frac{\text{explained variance}}{\text{unexplained variance}}=\frac{MSR}{MSE}\]<p>where $MSR$ refers to the “regression mean square” and $MSE$ is the “mean square error”. This statistic follows an $F$ distribution with 1 degree of freedom in the numerator and $n-1$ degrees of freedom in the denominator.</p><p>This statistic is the one used to test the hypothesis of statistical significance on $\beta_1$. That is, if for a simple linear regression model, the value calculated for $F$ is greater than the percentile of the $F$ distribution with $(1 ; n-2)$ degrees of freedom for an established error level $\alpha$, then the null hypothesis is rejected and it is concluded that variable $X$ does have a significant effect on variable $Y$.</p><p>Or analogously, one can read the p-value as usual, if the p-value is less than $\alpha$, the null hypothesis is rejected and one concludes that the variable $X$ does have a statistically significant effect on $Y$.</p><h2 id="goodness-of-fit">Goodness of fit</h2><p>We can compute some metrics to evaluate the performance of our model. In the case of <em>linear regression</em>, the coefficient of determination or R-Squared (R2) is used as a measure to quantify the variability of $Y$ explained by the model. The higher the coefficient the better the model explains reality.</p><p>In the case of <em>simple</em> linear regression, it coincides with the square of Pearson’s correlation coefficient.</p>\[R^2 = \frac{\sigma_{xy}^2}{\sigma_{x}^2 \sigma_{y}^2}\]<p>This coefficient is between 0 and 1.</p><p>It can also be written as:</p>\[R^2 = \frac{SSR}{TSS}\]<p>Where $SSR$ is the “sum of squares due to regression” (also called <em>explained sum of squares ESS</em>) and $TSS$ is the “total sum of squares”</p><p>The coefficient of determination has the following characteristics:</p><ul><li>$R^2$ values close to 1 will indicate a good fit of the model to the data.<li>In general, $R^2$ values close to 0 will indicate a poor fit of the model to the data. However, this depends on the study, in some statistical and machine learning studies finding $R^2$ values of 1% is common due to the nature of the dependent variable. For example, this is frequent when the objective is analyzing/predicting human behavior (human behavior is highly unpredictable).</ul><p>Example:</p><p>Imagine training/fitting a linear regression to detect <strong>brain age</strong> with an $R^2$ of 78%. This means the variability of <strong>brain age</strong> is explained in 78% by the model</p><p>In Python to get the $R^2$ we can use <code class="language-plaintext highlighter-rouge">r2_score</code> from <code class="language-plaintext highlighter-rouge">sklearn.metrics</code> as follows:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="c1"># X are the features/ independent variable(s)
</span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">r2_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></table></code></div></div><p>In R we can simply call <code class="language-plaintext highlighter-rouge">summary(model)$r.squared</code></p><h2 id="statistical-assumptions">Statistical assumptions</h2><p>There are several statistical assumptions to consider when fitting a simple linear model:</p><ul><li><p><strong>Linearity</strong>:</p><p>As mentioned previously, there should be a linear existent relation between $X$ and $Y$, so we can create what we call linear regression:</p>\[f(x) = \beta_0 + \beta_1 x\]<li><p><strong>Normality</strong>:</p><p>The residuals of a model follow a normal distribution, this means that for the i-th observation the error is assumed as normally distributed:</p>\[\varepsilon_i \sim N(0, \sigma^2)\]<li><p><strong>Homogeneity</strong>:</p><p>The expected value of the residuals is zero,</p>\[\mathbb{E}[\varepsilon_i]=0\]<li><p><strong>Homoscedasticity</strong></p><p>The variance of the residuals is constant, which means the dispersion of the data should be constant</p>\[VAR(\varepsilon_i) = \sigma^2\]<li><p><strong>Independency</strong></p><p>the observations should be independent,</p>\[\mathbb{E}[\varepsilon_i \varepsilon_j]=0\]<p>This means one observations should <strong>not</strong> give information about the others (This is a missing characteristic in time series data, as past observations are linked to future observations)</p></ul><h2 id="parameter-inference">Parameter inference</h2><p>Once we estimate the parameters of a simple linear model we are also interested in having a measure of precision on those estimates to verify whether the calculated values could be the true values for our parameters. This can be done by statistical inference.</p><p>To do so, we can create and test the following statistical hypotheses:</p>\[H_0: \beta_0 = 0\] \[H_a: \beta_0 \neq 0\]<p>and</p>\[H_0: \beta_1 = 0\] \[H_a: \beta_1 \neq 0\]<p>Contrasting these hypotheses implies calculating the next test statistic:</p>\[t=\frac{\hat{\beta}_i}{\sqrt{\hat{VAR}(\hat{\beta}_i)}}\]<p>This statistic follows a $t$-distribution with $n-2$ degrees of <a href="https://en.wikipedia.org/wiki/Degrees_of_freedom_(statistics)">freedom</a>. This means that the null hypothesis is rejected at the $\alpha$ level of significance if the absolute value of the statistic is greater than the $\alpha /2$ percentile of the $t$-distribution with $n-2$ degrees of freedom. Or analogously, when the calculated p-value is less than $\alpha$.</p><p>But how can we compute this statistic?</p><p>The first thing to know is that both $\beta_0$ and $\beta_1$ are also random variables and both follow a normal distribution since both are produced by linear combinations of normals. To prove this we can rewrite the expressions to compute the estimations as follows:</p><ul><li><p>For the <em>slope</em> parameter:</p>\[\hat{\beta}_1 = \frac{\sum{(x_i -\bar{x})(y_i -\bar{y})}}{\sum{(x_i - \bar{x})^2}}=\frac{\sum{(x_i -\bar{x})}Y_i}{\sum{(x_i - \bar{x})^2}}\]<p>This last expression is produced using the equivalence:</p>\[S_{xy}=\sum{(x_i -\bar{x})(y_i -\bar{y})}=\sum{(x_i -\bar{x})}y_i\]<li><p>For the <em>intercept</em> parameter:</p>\[\hat{\beta}_0=\bar{Y} - \hat{\beta}_1 \bar{x}\]</ul><p>As both expressions are written in terms of $Y_i$, where $Y_i \sim N(\beta_0 + \beta_1 x_i, \sigma^2)$, using the properties of <strong>expected value</strong> and <strong>variance</strong>, we can find the normal distributions of both parameters:</p>\[\hat{\beta}_1 \sim N \left(\beta_1, \frac{\sigma^2}{(n-1)S_{xx}} \right)\] \[\hat{\beta}_0 \sim N\left(\beta_0, \sigma^2 \left( \frac{1}{n} + \frac{\bar{x}^2}{(n-1)S_{xx}}\right) \right)\]<p>By using these distributions, we can construct confidence intervals for the parameters using the $t$-distribution. These have the following form:</p>\[CI(\beta_0)=\hat{\beta}_0 \pm t_{\frac{\alpha}{2}, n-2}\sqrt{\hat{VAR}(\hat{\beta}_0)}\] \[CI(\beta_1)=\hat{\beta}_1 \pm t_{\frac{\alpha}{2}, n-2}\sqrt{\hat{VAR}(\hat{\beta}_1)}\]<p>Usually these statistics are computed automatically in libraries and modules in <code class="language-plaintext highlighter-rouge">R</code> and <code class="language-plaintext highlighter-rouge">Python</code>.</p><p>In R using the following lines will give you all sorts of information about the model:</p><div class="language-R highlighter-rouge"><div class="code-header"> <span text-data=" R "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p>In <code class="language-plaintext highlighter-rouge">Python</code> we can compute all statistics by hand after computing the coefficients using <code class="language-plaintext highlighter-rouge">scikit-learn</code> or simply use the module <code class="language-plaintext highlighter-rouge">statsmodels</code> as follows:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="n">sm</span>
<span class="n">model_results</span> <span class="o">=</span> <span class="n">sm</span><span class="p">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">).</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">results</span><span class="p">.</span><span class="n">summary</span><span class="p">())</span>
</pre></table></code></div></div><h2 id="practical-example">Practical example</h2><p>After all of this dense mathematical introduction, let me show an example.</p><p>In this case I am going to use R exclusively, since it is more convenient for this case in which we are trying to understand statistical concepts.</p><p>I always recommend using R when the task is exclusively based on <strong>statistical data analysis</strong> and using Python for <strong>machine learning</strong> tasks. This is because R offers a variety of built-in statistical methods that are quite useful when working with linear models or statistical tests.</p><p>However, it depends on the preferences and tasks of the practitioner; if you are fitting a linear model and your interest is to generalize over a test set, you may always find it more convenient to use modules such as <code class="language-plaintext highlighter-rouge">scikit-learn</code>, <code class="language-plaintext highlighter-rouge">Tensorflow</code> or <code class="language-plaintext highlighter-rouge">PyTorch</code> in Python.</p><p>In this case we will be using the dataset <code class="language-plaintext highlighter-rouge">diamonds</code> from <a href="https://ggplot2.tidyverse.org/reference/diamonds.html"><code class="language-plaintext highlighter-rouge">ggplot2</code></a>. This is a dataset containing the prices and other attributes of almost 54,000 diamonds.</p><p>This is how we can start loading the data and plotting some interesting descriptive statistics</p><div class="language-R highlighter-rouge"><div class="code-header"> <span text-data=" R "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># It is a good coding practice to import your libraries on the top of the code!</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">

</span><span class="c1"># Load the data and generate a descriptive statistics summary</span><span class="w">
</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><pre><code class="language-Output">     carat               cut        color        clarity          depth           table           price             x         
 Min.   :0.2000   Fair     : 1610   D: 6775   SI1    :13065   Min.   :43.00   Min.   :43.00   Min.   :  326   Min.   : 0.000  
 1st Qu.:0.4000   Good     : 4906   E: 9797   VS2    :12258   1st Qu.:61.00   1st Qu.:56.00   1st Qu.:  950   1st Qu.: 4.710  
 Median :0.7000   Very Good:12082   F: 9542   SI2    : 9194   Median :61.80   Median :57.00   Median : 2401   Median : 5.700  
 Mean   :0.7979   Premium  :13791   G:11292   VS1    : 8171   Mean   :61.75   Mean   :57.46   Mean   : 3933   Mean   : 5.731  
 3rd Qu.:1.0400   Ideal    :21551   H: 8304   VVS2   : 5066   3rd Qu.:62.50   3rd Qu.:59.00   3rd Qu.: 5324   3rd Qu.: 6.540  
 Max.   :5.0100                     I: 5422   VVS1   : 3655   Max.   :79.00   Max.   :95.00   Max.   :18823   Max.   :10.740  
                                    J: 2808   (Other): 2531                                                                   
       y                z         
 Min.   : 0.000   Min.   : 0.000  
 1st Qu.: 4.720   1st Qu.: 2.910  
 Median : 5.710   Median : 3.530  
 Mean   : 5.735   Mean   : 3.539  
 3rd Qu.: 6.540   3rd Qu.: 4.040  
 Max.   :58.900   Max.   :31.800     
</code></pre><p>In these statistics we can see a summary of the different characteristics of the 54,000 diamonds in the dataset, including color distribution, average price and carat count. We can then try to find some relationships in the data with scatter plots and correlations.</p><p>For this example we are interested in finding the relationship between the price and carat of all diamonds, we can see from the statistics above that the scales for both variables are different, we can re-confirm this visually with the next scatter plot:</p><div class="language-R highlighter-rouge"><div class="code-header"> <span text-data=" R "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># Plot the relationship between carats and price by color </span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">carat</span><span class="p">,</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">
</span><span class="n">cor</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">carat</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">price</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/posts/linear_models/diamonds_scatter.png" alt="ScatterPlotDiamonds" /></p><p>In the plot we can also see the linear trend visually between both attributes, for <code class="language-plaintext highlighter-rouge">price</code> and <code class="language-plaintext highlighter-rouge">carat</code> the correlation is 0.9215913 which indicates a strong linear relation, this in the end allows us to model the data with linear regression as follows:</p>\[price_i = \beta_0 + \beta_1 \cdot carat_i\]<div class="language-R highlighter-rouge"><div class="code-header"> <span text-data=" R "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">price</span><span class="o">~</span><span class="n">carat</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><pre><code class="language-output">Call:
lm(formula = price ~ carat, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-18585.3   -804.8    -18.9    537.4  12731.7 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2256.36      13.06  -172.8   &lt;2e-16 ***
carat        7756.43      14.07   551.4   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1549 on 53938 degrees of freedom
Multiple R-squared:  0.8493,	Adjusted R-squared:  0.8493 
F-statistic: 3.041e+05 on 1 and 53938 DF,  p-value: &lt; 2.2e-16
</code></pre><p>We can see in these results the coefficients in the <code class="language-plaintext highlighter-rouge">Estimate</code> field and the different statistics that we discussed in the previous sections such as the test statistic <code class="language-plaintext highlighter-rouge">t test</code>.</p><p>If we look at the p-values of the parameters associated with the intercept and carat, we can say that both are statistically significant as the <em>p-value &lt; 0.05</em>. We can also see how good the goodness of fit of the model is by looking at the $R^2=0.8493$, which means that ~85% of the price variability is explained by the model (In this case is not a great performance, taking into account the characteristics of the dependent variable <code class="language-plaintext highlighter-rouge">price</code>).</p><p>For the interpretation of the coefficients, we see that the intercept does not have a direct interpretation, because when the carat is 0 the price is -2256 dollars, which does not make any sense. However, we can see for the case of the parameter associated with the explanatory variable that as the carat increases by one unit, the price increases by 7756.43 dollars.</p><p>We can take a look at the statistical significance of the parameters with the analysis of variance of the model using <code class="language-plaintext highlighter-rouge">anova(model)</code>. This line will give the following results:</p><pre><code class="language-output">Analysis of Variance Table

Response: price
             Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
carat         1 7.2913e+11 7.2913e+11  304051 &lt; 2.2e-16 ***
Residuals 53938 1.2935e+11 2.3980e+06                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</code></pre><p>This is a representation of the highlighted table discussed in the <a href="#variance-analysis">Analysis of Variance</a> section containing all the aforementioned statistics, where in this case the <em>p-value &lt;0.05</em> indicates the carat explains the diamond price and it is a necessary explanatory variable in our final model.</p><p>The final linear model equation could be written as follows:</p>\[\hat{price} = -2256.36 + 7756.43 (carat)\]<p>We can use this equation by substituting carat for a given quantity to make some predictions.</p><p>Note that further analysis of this model is required to know if it is good enough to explain the desired relationship. This involves analyzing the residuals to verify that our model works correctly and follows the <a href="#statistical-assumptions">statistical assumptions</a> we mentioned previously. This is going to be investigated using some additional statistical tests and plots in a new another post.</p><p>Cite:</p><div class="language-bibtex highlighter-rouge"><div class="code-header"> <span text-data=" Bibtex "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nc">@misc</span><span class="p">{</span><span class="nl">LinearModels101Intro</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Miguel A. Alba}</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{Linear models 101! - Introduction: Simple Linear Regression}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="m">2021</span><span class="p">,</span>
  <span class="na">url</span> <span class="p">=</span> <span class="s">{https://miguelalba96.github.io/posts/LinearModels-intro}</span><span class="p">,</span>
  <span class="na">urldate</span> <span class="p">=</span> <span class="s">{2021-10-14}</span>
<span class="p">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/statistics/'>Statistics</a>, <a href='/categories/predictive-modeling/'>Predictive Modeling</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linear-models/" class="post-tag no-text-decoration" >Linear Models</a> <a href="/tags/statistics/" class="post-tag no-text-decoration" >Statistics</a> <a href="/tags/inference/" class="post-tag no-text-decoration" >Inference</a> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >Machine learning</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Linear models 101! - Introduction - Miguel Alba&url=https://miguelalba96.github.io/posts/LinearModels-intro/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Linear models 101! - Introduction - Miguel Alba&u=https://miguelalba96.github.io/posts/LinearModels-intro/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://miguelalba96.github.io/posts/LinearModels-intro/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Welcome/">Welcome!</a><li><a href="/posts/Tensorflow-low-level-API/">How to build deep neural networks using Tensorflow low level API (tf.Module)</a><li><a href="/posts/FisherInformation-DL/">The relevance of the Fisher Information Matrix in Deep Neural Networks</a><li><a href="/posts/LinearModels-intro/">Linear models 101! - Introduction</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/deep-neural-networks/">Deep neural networks</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/continual-learning/">Continual learning</a> <a class="post-tag" href="/tags/fisher-information-matrix/">Fisher Information Matrix</a> <a class="post-tag" href="/tags/inference/">Inference</a> <a class="post-tag" href="/tags/linear-models/">Linear Models</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/statistics/">Statistics</a> <a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/welcome/">Welcome</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Tensorflow-low-level-API/"><div class="card-body"> <span class="timeago small" >Nov 28, 2021<i class="unloaded">2021-11-28T21:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to build deep neural networks using Tensorflow low level API (tf.Module)</h3><div class="text-muted small"><p> Introduction Just before the release of Tensorflow 2.0 (mid 2019), developing large and complex deep learning models with Tensorflow 1.x required some understanding of how static graph semantics w...</p></div></div></a></div><div class="card"> <a href="/posts/FisherInformation-DL/"><div class="card-body"> <span class="timeago small" >Jan 22<i class="unloaded">2022-01-22T19:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The relevance of the Fisher Information Matrix in Deep Neural Networks</h3><div class="text-muted small"><p> Introduction Deep models have always been considered as black boxes, where provided that sufficient and clean data and a clear problem statement are available, they can produce models with reliabl...</p></div></div></a></div><div class="card"> <a href="/posts/Welcome/"><div class="card-body"> <span class="timeago small" >Oct 13, 2021<i class="unloaded">2021-10-13T01:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Welcome!</h3><div class="text-muted small"><p> Hi, I am Miguel, this is my website and research blog. If you are interested in my profile you can find here information about my educational background and experience. If you are interested in wo...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Welcome/" class="btn btn-outline-primary" prompt="Older"><p>Welcome!</p></a> <a href="/posts/Tensorflow-low-level-API/" class="btn btn-outline-primary" prompt="Newer"><p>How to build deep neural networks using Tensorflow low level API (tf.Module)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/miguelalba96">Miguel Alba</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/deep-neural-networks/">Deep neural networks</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/continual-learning/">Continual learning</a> <a class="post-tag" href="/tags/fisher-information-matrix/">Fisher Information Matrix</a> <a class="post-tag" href="/tags/inference/">Inference</a> <a class="post-tag" href="/tags/linear-models/">Linear Models</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/statistics/">Statistics</a> <a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/welcome/">Welcome</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://miguelalba96.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
